<!DOCTYPE html>
<!--TO DO:
  - y-values for each point in path:
      - find out what "d" attribute is in the path method b/c my points don't have some of the vals-->
<html lang="en">
<!-- Referance from: https://code.tutsplus.com/tutorials/building-a-multi-line-chart-using-d3js--cms-22935
and https://code.tutsplus.com/tutorials/building-a-multi-line-chart-using-d3js-part-2--cms-22973
and http://bl.ocks.org/d3noob/d8be922a10cb0b148cd5 -->
<head>
</head>
<link rel="stylesheet" type="text/css" href="murray.axes.css">
<body>

  <div class="container">

      <div class="jumbotron">

<!-- Create the SVG element-->
  <svg id="visualisation" width="1000" height="500"></svg>

  <script src="http://d3js.org/d3.v3.min.js" charset="utf-8"></script>

  <script >
    console.log("HI there!");

    // DUMMY DATA:
    var data = [
{
"class": "1",
"values": [{
    "month": "01",
    "year" : "2016",
    "totM": "50",
    "totG": "43"
  }, {
    "month": "02",
    "year" : "2016",
    "totM": "51",
    "totG": "27"
  }, {
    "month": "03",
    "year" : "2016",
    "totM": "100",
    "totG": "44"
  }]
},
{
"class": "03",
"values": [{
    "month": "01",
    "year" : "2016",
    "totM": "122",
    "totG": "80"
  }, {
    "month": "02",
    "year" : "2016",
    "totM": "67",
    "totG": "110"
  }, {
    "month": "03",
    "year" : "2016",
    "totM": "20",
    "totG": "22"
  }]
},
{
"class": "3",
"values": [{
    "month": "01",
    "year" : "2016",
    "totM": "74",
    "totG": "39"
  }, {
    "month": "02",
    "year" : "2016",
    "totM": "38",
    "totG": "33"
  }, {
    "month": "03",
    "year" : "2016",
    "totM": "26",
    "totG": "25"
  }]
},
{
"class": "4",
"values": [{
    "month": "01",
    "year" : "2016",
    "totM": "11",
    "totG": "15"
  }, {
    "month": "02",
    "year" : "2016",
    "totM": "17",
    "totG": "19"
  }, {
    "month": "03",
    "year" : "2016",
    "totM": "21",
    "totG": "24"
  }]
},
{
"class": "5",
"values": [{
  "month": "01",
  "year" : "2016",
  "totM": "23",
  "totG": "10"
}, {
  "month": "02",
  "year" : "2016",
  "totM": "30",
  "totG": "12"
}, {
  "month": "03",
  "year" : "2016",
  "totM": "31",
  "totG": "13"
}]
}];

console.log(data);

    var vis = d3.select("#visualisation"),
       WIDTH = 1000,
      HEIGHT = 500,
      MARGINS = {
        top: 50,
        right: 20,
        bottom: 50,
        left: 50,
      },
      // NEED TO INCLUDE THE ARRAYS FROM THE DATA PARSING TO USE THIS!
      // For the y-scale, max # of words any line will reach cannot be more than all moral W or all general W.
    //   maxWordCount = fuction(){ if (generalWords.length >moralWords.length) {
    //     return generalWords.length;
    //   }
    //   else {
    //     return moralWords.length;
    //   }
    // }
      minDate = new Date(2015, 08-1), // new Date function counts Jan as 01 and Dec as 11
      maxDate = new Date(2016, 10-1),
      xScale = d3.time.scale().range([MARGINS.left, WIDTH - MARGINS.right]).domain([minDate, maxDate]), //Left the domain unset b/c its fn of time
      yScale = d3.scale.linear().range([HEIGHT- 2*MARGINS.bottom, MARGINS.top]).domain([0, 124]), //Not Dynamic :: use maxWordCount instead

      xAxis = d3.svg.axis()
        .scale(xScale)
        .orient("bottom")//Plan to have a tick for each month (tick centered on Hover-Bar)
        .tickFormat(d3.time.format("%Y-%B")),  // tickFormat
      yAxis = d3.svg.axis()
        .scale(yScale)
        .orient("left")
        .ticks(5);

      // Append the X and Y axes to the svg
      vis.append("svg:g")
        .attr("transform", "translate(0," + (HEIGHT - 2*MARGINS.bottom) + ")")
        .call(xAxis)
        .selectAll("text")
          .style("text-anchor", "end")
          .attr("dx", "-.8em")
          .attr("dy", ".15em")
          .attr("transform", function(d){
            return "rotate(-65)"
          });

      vis.append("svg:g")
        .attr("transform", "translate(" + (MARGINS.left) + ",0)")
        .call(yAxis);

      // Creating the line

      // Line Generation function
      // takes an array of objects called values: [{"month": "01", "totM": "", "totG": ""}, {"month": "02"...}, etc.]
      var moralLineGen = d3.svg.line() // need to change the x & y-vals for each Month
        .x(function(d){
          console.log(new Date(d.year, d.month-1));
          console.log("date scaled:")
          console.log(xScale(new Date(d.year, d.month-1)));
          var date = new Date(d.year, d.month-1); // new Date function counts Jan as 01 and Dec as 11
          return xScale(date);
        })
        .y(function(d){
          console.log(d.totM);
          console.log("y-val scaled:")
          console.log(yScale(d.totM));
          return yScale(d.totM);
        })
        .interpolate("basis");

        // takes an array of objects called values: [{"month": "01", "totM": "", "totG": ""}, {"month": "02"...}, etc.]
        var generalLineGen = d3.svg.line() // need to change the x & y-vals for each Month
          .x(function(d){
            return xScale(new Date(d.year, d.month-1)); // new Date function counts Jan as 01 and Dec as 11
          })
          .y(function(d){
            return yScale(d.totG);
          })
          .interpolate("basis");

      // Add Color code: (reference: http://bl.ocks.org/aaizemberg/78bd3dade9593896a59d)
      var c10 = d3.scale.category10();

      // If data is set up with [{"key": "class#1", "values": [{"month": "01", "totM": "", "totG": ""}, {"month": "02"...}, etc.]}, {"key": "class#2", "values": [{"month": "01", "totM": "", "totG": ""}, {"month": "02"...}, etc.]}
      // For each CLASS...
      data.forEach(function(d,i){

        // Create the moral line
        vis.append('svg:path')
          .attr('d', moralLineGen(d.values))
          .attr('stroke', c10(d.class))
          .attr('stroke-width', 2)
          .attr('fill', 'none')
          // .attr("data-legend", function(d){
          //   return d.class;})
            ;

        // Create the legend for the moral line

        // vis.append("g")
        //   .attr("class", "legend")
        //   .attr("transform", "translate(" + WIDTH - MARGINS.right + "," + MARGINS.top")")
        //   .attr("font-size", "12px")
        //   .call(d3.legend);

        // Create the general line
        vis.append('svg:path')
            .attr('d', generalLineGen(d.values))
            .attr('stroke', c10(d.class))
            .style("stroke-dasharray", ("3, 3")) // from: http://www.d3noob.org/2013/01/making-dashed-line-in-d3js.html
            .attr('stroke-width', 2)
            .attr('fill', 'none');
      });

/*/ Just work on moral line for now
      // If data is set up with [{"key": "class#1", "values": [{"month": "01", "totM": "", "totG": ""}, {"month": "02"...}, etc.]}, {"key": "class#2", "values": [{"month": "01", "totM": "", "totG": ""}, {"month": "02"...}, etc.]}
      data.forEach(function(d,i){
        vis.append('svg:path')
          .attr('d', generalLineGen(d.values))
          .attr('stroke', 'blue')
          .attr('stroke-width', 2)
          .attr('fill', 'none');
      });
*/
  </script>

</div>
</div>

</body>
</html>
